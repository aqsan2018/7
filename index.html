<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Kiss Filler</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/matter-js/0.19.0/matter.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Comic Sans MS', 'Chalkboard SE', 'Marker Felt', sans-serif;
            background-color: #fce7f3; /* Light pink */
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
            overflow: hidden;
            touch-action: none; /* Disable panning/zooming on mobile */
        }

        #container {
            position: relative;
            width: 100vw;
            height: 100vh;
            overflow: hidden;
        }

        #instructions {
            position: absolute;
            top: 35%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 2rem;
            color: #db2777; /* Hot pink */
            text-align: center;
            font-weight: bold;
            z-index: 10;
            pointer-events: none;
            user-select: none;
        }

        #final-message {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 2.5rem;
            color: #be185d; /* Deeper pink */
            text-align: center;
            font-weight: bold;
            z-index: 300;
            pointer-events: none;
            user-select: none;
            opacity: 0;
            transition: opacity 1s ease-in-out;
            background-color: rgba(255, 255, 255, 0.5);
            padding: 2rem;
            border-radius: 1rem;
            backdrop-filter: blur(5px);
        }

        #click-counter {
            position: absolute;
            top: 20px;
            left: 20px;
            font-size: 1.5rem;
            color: #9d174d;
            z-index: 10;
            user-select: none;
        }

        /* This is the canvas for Matter.js - now VISIBLE */
        canvas {
            position: absolute;
            top: 0;
            left: 0;
            z-index: 1; /* Behind the UI elements */
        }

    </style>
</head>
<body>

    <div id="container">
        <div id="instructions">I'm feeling a little un-loved.<br>Click to fill me up!</div>
        <div id="final-message">Okay, okay, I get it...<br>now come give me the real ones. ðŸ˜‰</div>
        <div id="click-counter">Kisses: 0</div>
        <!-- Matter.js will create its own canvas here -->
    </div>

    <!-- Audio files -->
    <audio id="boop-sound" src="boop.mp3" preload="auto"></audio>
    <audio id="reveal-sound" src="reveal_ding.mp3" preload="auto"></audio>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- Matter.js Setup ---
            const { Engine, Render, Runner, World, Bodies, Body, Events } = Matter;

            const container = document.getElementById('container');
            const instructions = document.getElementById('instructions');
            const finalMessage = document.getElementById('final-message');
            const clickCounter = document.getElementById('click-counter');
            const boopSound = document.getElementById('boop-sound');
            const revealSound = document.getElementById('reveal-sound');

            const worldWidth = window.innerWidth;
            const worldHeight = window.innerHeight;
            const ballSize = 20; // Radius of the balls
            const clicksToReveal = 100; // Changed to 100
            let clickCount = 0;
            let messageRevealed = false;

            // Create engine
            const engine = Engine.create({
                gravity: { y: 0.4 },
                enableSleeping: true
            });
            const world = engine.world;

            // Create a VISIBLE renderer
            const render = Render.create({
                element: container,
                engine: engine,
                options: {
                    width: worldWidth,
                    height: worldHeight,
                    wireframes: false, // Show solid colors
                    background: 'transparent'
                }
            });
            Render.run(render);

            // Create runner
            const runner = Runner.create();
            Runner.run(runner, engine);

            // --- Create Walls ---
            const wallOptions = {
                isStatic: true,
                render: { visible: false } // Hide the walls
            };
            World.add(world, [
                // Floor (Simple, flat floor)
                Bodies.rectangle(worldWidth / 2, worldHeight + 30, worldWidth + 100, 60, wallOptions),
                
                // Left wall
                Bodies.rectangle(-30, worldHeight / 2, 60, worldHeight, wallOptions),
                // Right wall
                Bodies.rectangle(worldWidth + 30, worldHeight / 2, 60, worldHeight, wallOptions)
            ]);
            
            // --- Click/Touch Event ---
            function addBall(x, y) {
                if (messageRevealed) return; 
                
                clickCount++;
                clickCounter.textContent = `Kisses: ${clickCount}`;

                boopSound.currentTime = 0;
                boopSound.play().catch(e => console.log("Audio play prevented"));

                const ballColor = Math.random() < 0.5 ? '#db2777' : '#be185d'; // Hot pink or Deeper pink

                // 2. Create the Matter.js body at the same location
                const body = Bodies.circle(x, y, ballSize, {
                    restitution: 0.5,
                    friction: 0.3,
                    density: 0.01,
                    isSleeping: false,
                    render: {
                        fillStyle: ballColor,
                        strokeStyle: 'transparent'
                    }
                });
                World.add(world, body);

                // 3. Hide instructions after first click
                if (clickCount === 1) {
                    instructions.style.transition = 'opacity 0.5s';
                    instructions.style.opacity = '0';
                }

                // 4. Check for reveal
                if (clickCount >= clicksToReveal && !messageRevealed) {
                    messageRevealed = true;
                    finalMessage.style.opacity = '1';
                    revealSound.play().catch(e => console.log("Audio play prevented"));
                }
            }
            
            container.addEventListener('mousedown', (e) => {
                addBall(e.clientX, e.clientY);
            });
            
            container.addEventListener('touchstart', (e) => {
                e.preventDefault(); 
                const touch = e.touches[0];
                addBall(touch.clientX, touch.clientY);
            }, { passive: false });


            // --- Handle Window Resize ---
            window.addEventListener('resize', () => {
                // For a complex physics simulation, a full reload is often the easiest way to handle resize.
                location.reload();
            });

        });
    </script>
</body>
</html>

