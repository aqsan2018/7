<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Kiss Filler</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/matter-js/0.19.0/matter.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Comic Sans MS', 'Chalkboard SE', 'Marker Felt', sans-serif;
            background-color: #fce7f3; /* Light pink */
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
            overflow: hidden;
            touch-action: none; /* Disable panning/zooming on mobile */
        }

        #container {
            position: relative;
            width: 100vw;
            height: 100vh;
            overflow: hidden;
        }

        #instructions {
            position: absolute;
            top: 35%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 2rem;
            color: #db2777; /* Hot pink */
            text-align: center;
            font-weight: bold;
            z-index: 10;
            pointer-events: none;
            user-select: none;
        }

        #final-message {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 2.5rem;
            color: #be185d; /* Deeper pink */
            text-align: center;
            font-weight: bold;
            z-index: 300;
            pointer-events: none;
            user-select: none;
            opacity: 0;
            transition: opacity 1s ease-in-out;
            background-color: rgba(255, 255, 255, 0.5);
            padding: 2rem;
            border-radius: 1rem;
            backdrop-filter: blur(5px);
        }

        #click-counter {
            position: absolute;
            top: 20px;
            left: 20px;
            font-size: 1.5rem;
            color: #9d174d;
            z-index: 10;
            user-select: none;
        }

        /* This is the canvas for Matter.js - now VISIBLE */
        canvas {
            position: absolute;
            top: 0;
            left: 0;
            z-index: 1; /* Behind the UI elements */
        }
    </style>
</head>
<body>

    <div id="container">
        <div id="instructions">I'm feeling a little un-loved.<br>Click to fill me up!</div>
        <div id="final-message">Okay, okay, I get it...<br>now come give me the real ones. ðŸ˜‰</div>
        <div id="click-counter">Kisses: 0</div>
        <!-- Matter.js will create its own canvas here -->
    </div>

    <!-- Audio files -->
    <audio id="boop-sound" src="boop.mp3" preload="auto"></audio>
    <audio id="reveal-sound" src="reveal_ding.mp3" preload="auto"></audio>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const { Engine, Render, Runner, World, Bodies, Body, Events } = Matter;

            const container = document.getElementById('container');
            const instructions = document.getElementById('instructions');
            const finalMessage = document.getElementById('final-message');
            const clickCounter = document.getElementById('click-counter');
            const boopSound = document.getElementById('boop-sound');
            const revealSound = document.getElementById('reveal-sound');

            const worldWidth = window.innerWidth;
            const worldHeight = window.innerHeight;
            const emojiSize = 30;
            const clicksToReveal = 100; // Set to 100
            let clickCount = 0;
            let messageRevealed = false;

            // --- THIS IS THE NEW MESSAGE LIST ---
            // --- ADD ALL YOUR 50-60 MESSAGES HERE ---
            const finalMessages = [
                "Okay, okay, I get it...<br>now come give me the real ones. ðŸ˜‰",
                "You've unlocked: 100 Kisses! <br>Claim your prize in person.",
                "My 'Mutallo' is the best clicker! â¤ï¸",
                "Wow, 100! You must really love me.",
                "Your score is... 100% CUTE!",
                "Add your next message here...",
                "And another one here...",
                "...keep going!"
                // Add all 50-60 of your messages here
            ];
            // --- END OF MESSAGE LIST ---

            const emojis = ['ðŸ’‹', 'â¤ï¸', 'ðŸ˜˜', 'ðŸ’•', 'ðŸ’–', 'ðŸ’ž'];

            // Matter.js engine setup
            const engine = Engine.create({ gravity: { y: 0.4 } });
            const world = engine.world;

            // Create renderer (weâ€™ll override drawing)
            const render = Render.create({
                element: container,
                engine: engine,
                options: {
                    width: worldWidth,
                    height: worldHeight,
                    wireframes: false,
                    background: '#fce7f3' // Match body background
                }
            });
            Render.run(render);
            const runner = Runner.create();
            Runner.run(runner, engine);

            // Walls
            const wallOptions = { isStatic: true, render: { visible: false } };
            World.add(world, [
                // Flat floor to collect them
                Bodies.rectangle(worldWidth / 2, worldHeight + 30, worldWidth + 100, 60, wallOptions),
                // Left wall
                Bodies.rectangle(-30, worldHeight / 2, 60, worldHeight, wallOptions),
                // Right wall
                Bodies.rectangle(worldWidth + 30, worldHeight / 2, 60, worldHeight, wallOptions)
            ]);

            // Custom rendering hook for emoji
            const emojiBodies = new Map();

            Events.on(render, 'afterRender', () => {
                const ctx = render.context;
                // Set font properties *every frame* (safer)
                ctx.font = `${emojiSize}px "Segoe UI Emoji", "Apple Color Emoji", sans-serif`;
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';

                emojiBodies.forEach((emoji, body) => {
                    ctx.save();
                    ctx.translate(body.position.x, body.position.y);
                    ctx.rotate(body.angle);
                    ctx.fillText(emoji, 0, 0);
                    ctx.restore();
                });
            });

            function addEmoji(x, y) {
                if (messageRevealed) return;

                clickCount++;
                clickCounter.textContent = `Kisses: ${clickCount}`;
                boopSound.currentTime = 0;
                boopSound.play().catch(() => {});

                const emoji = emojis[Math.floor(Math.random() * emojis.length)];

                const body = Bodies.circle(x, y, emojiSize / 2, {
                    restitution: 0.6,
                    friction: 0.3,
                    density: 0.01
                    // <-- Removed the 'render: { fillStyle: 'transparent' }' line here
                });
                World.add(world, body);
                emojiBodies.set(body, emoji);

                if (clickCount === 1) {
                    instructions.style.transition = 'opacity 0.5s';
                    instructions.style.opacity = '0';
                }

                if (clickCount >= clicksToReveal && !messageRevealed) {
                    messageRevealed = true;

                    // --- NEW LOGIC TO GET A UNIQUE MESSAGE ---
                    // 1. Get the last index we showed (or -1 if it's the first time)
                    let lastIndex = parseInt(localStorage.getItem('lastKissMessageIndex') || '-1', 10);

                    // 2. Get the next index, and loop back to 0 if we're at the end
                    let nextIndex = lastIndex + 1;
                    if (nextIndex >= finalMessages.length) {
                        nextIndex = 0;
                    }

                    // 3. Save the new index for next time
                    localStorage.setItem('lastKissMessageIndex', nextIndex.toString());

                    // 4. Get the message and display it
                    const messageToShow = finalMessages[nextIndex];
                    finalMessage.innerHTML = messageToShow; // Use innerHTML to allow <br> tags

                    // 5. Show the message box
                    finalMessage.style.opacity = '1';
                    revealSound.play().catch(() => {});
                }
            }

            container.addEventListener('mousedown', e => addEmoji(e.clientX, e.clientY));
            container.addEventListener('touchstart', e => {
                e.preventDefault();
                const touch = e.touches[0];
                addEmoji(touch.clientX, touch.clientY);
            }, { passive: false });

            window.addEventListener('resize', () => location.reload());
        });
    </script>
</body>
</html>





